[package]
name = "backend"
version = "0.1.0"
edition = "2021"

# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html

[dependencies]
tikv-jemallocator = "0.5"
log = "0.4.18"
paste = "1.0.12"
prost = { workspace = true }
toml = { workspace = true }
prost-types = { workspace = true }
entity = { path = "./entity" }
chrono = "0.4.26"
thiserror = "1.0.44"
derive_builder = { workspace = true }
futures = "0.3.29"
bincode = "1.3.3"
base64 = "0.21.5"
uuid = "1.5.0"
tonic-web = "0.10.2"
quick_cache = "0.4.0"
leaky-bucket = "1.0.1"
hickory-resolver = "0.24.0"
crossbeam-queue = "0.3.8"
dashmap = "5.5.3"
tracing-opentelemetry = "0.22.0"
rand = "0.8.5"
rand_hc = "0.3.2"
blake2 = "0.10.6"
# a lot of opentelemetry dependencies
opentelemetry = { version = "0.21.0", features = ["metrics"] }
opentelemetry_sdk = { version = "0.21.1", features = ["rt-tokio", "metrics"] }
opentelemetry-stdout = { version = "0.2.0", features = ["metrics"] }
opentelemetry-semantic-conventions = "0.13.0"
opentelemetry-otlp = { version = "0.14.0", features = ["metrics"] }

[dependencies.reqwest]
version = "0.11.22"
features = ["rustls-tls", "json"]

[dependencies.k256]
version = "0.13.2"
features = ["arithmetic", "serde", "sha256"]

[dependencies.tokio-stream]
version = "0.1.14"
features = ["sync"]

[dependencies.tracing-subscriber]
workspace = true
features = ["json"]

[dependencies.tracing]
workspace = true
features = ["async-await", "log", "release_max_level_debug"]

[dependencies.tokio]
workspace = true
features = ["macros", "rt-multi-thread", "full", "time"]

[dependencies.sea-orm]
version = "0.12.2"
features = [
    "runtime-actix-rustls",
    "macros",
    "mock",
    "sqlx-sqlite",
    "with-chrono",
]

[dependencies.serde]
workspace = true
features = ["derive"]

[dependencies.tonic]
workspace = true
features = ["transport", "channel", "codegen", "tls", "prost"]

[dependencies.spin]
version = "0.9.8"
features = ["mutex", "spin_mutex", "rwlock"]

[build-dependencies.tonic-build]
workspace = true
features = ["transport", "prost"]


[features]
default = ["single-instance"]
unsecured-log = []
single-instance = []
